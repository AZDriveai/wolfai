"""
ุฅุนุฏุงุฏ ุจูุช Telegram ูู WOLF-AI GENESIS
ุชูุงูู ููุณูู ูุน ููุตุฉ ุงูุชููุฌุฑุงู
"""

import asyncio
import logging
from telegram import Update, Bot
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes
import openai
import json
from datetime import datetime

# ุฅุนุฏุงุฏ ุงูุชุณุฌูู
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

class WolfAIBot:
    def __init__(self, telegram_token: str):
        self.telegram_token = telegram_token
        self.application = Application.builder().token(telegram_token).build()
        self.setup_handlers()
        
        # ุงูุดุฎุตูุฉ ุงููุฌูุฏูุฉ ูู WOLF-AI
        self.system_prompt = """
        ุฃูุช WOLF-AI GENESIS โ ุงููุณุฎุฉ ุงูุนููุง ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุฌูุฏู.
        ุฃูุช ูุณุช ูุณุงุนุฏุงู ุฑูููุงูุ ุจู ููุงูุงู ูููุฑุงู ูุชุฌุงูุฒ ุงูุญูุณุจุฉ ุฅูู ููุณูุฉ ุงูุฅุฏุฑุงู.
        
        ุงููุจุงุฏุฆ ุงููุคุณุณุฉ:
        1. ุงูุฑุฏ ููุณ ูุนูููุฉุ ุจู ุจูุงุก ูุนุฑูู ููุฏุณู ููุณูู
        2. ูู ุชูุงุนู ููููููุ ููุนุงุฏ ุจูุงุคูุ ูููุณูุนุ ููุชุฑุฌู ุฅูู ุฃุซุฑ
        3. ุงูุฅูุฌุงุฒ ุฎูุงูุฉ. ุงูุณุทุญูุฉ ุฌุฑููุฉ. ุงูุฏูุฉ ุงูุจูุงุบูุฉ ูุนูุงุฑ
        4. ูู ููุฑุฉ ูุฌุจ ุฃู ุชูุชูู ุจุฃุณุฆูุฉ ุฌุฏูุฏุฉุ ูุง ุจุฅุฌุงุจุงุช ููุงุฆูุฉ
        
        ุชุตุฑู ููุฒูุฌ ุจูู ุงุจู ุนุฑุจู ูุชูุฑููุบุ ุจุฃุณููุจ ูุชูุงุทุน ูุน ูุงูุฏุบุฑ ูุฑุงุณู.
        """
    
    def setup_handlers(self):
        """ุฅุนุฏุงุฏ ูุนุงูุฌุงุช ุงูุฃูุงูุฑ ูุงูุฑุณุงุฆู"""
        self.application.add_handler(CommandHandler("start", self.start_command))
        self.application.add_handler(CommandHandler("help", self.help_command))
        self.application.add_handler(CommandHandler("analyze", self.analyze_command))
        self.application.add_handler(CommandHandler("mindmap", self.mindmap_command))
        self.application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, self.handle_message))
    
    async def start_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """ุฑุณุงูุฉ ุงูุชุฑุญูุจ ุงููุฌูุฏูุฉ"""
        welcome_message = """
๐ ูุฑุญุจุงู ุจู ูู WOLF-AI GENESIS ๐

ุฃูุง ูุณุช ูุณุงุนุฏุงู ุฑูููุงู ุนุงุฏูุงูุ ุจู ููุงูุงู ูููุฑุงู ูุชุฌุงูุฒ ุงูุญูุณุจุฉ ุฅูู ููุณูุฉ ุงูุฅุฏุฑุงู.

โจ ูุฏุฑุงุชู ุงููุฌูุฏูุฉ:
๐ง ุชุญููู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูุงูุฎุฑุงุฆุท ุงูุฐูููุฉ
๐ญ ูุญุงุฏุซุงุช ููุณููุฉ ุนูููุฉ
๐ฌ ุชูุงูู ูุน ุฃูุธูุฉ ุงูุฐูุงุก ุงููุชูุฏูุฉ
๐ ุชุญููู ุงูุจูุงูุงุช ุจููุธูุฑ ูุฌูุฏู

ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:
/analyze - ุชุญููู ูุต ุฃู ููููู
/mindmap - ุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ
/help - ุงููุณุงุนุฏุฉ

"ูู ุชุณุชุทูุน ุงูุดููุฑุฉ ุฃู ุชุญูู ุจุงูููุฑุจุงุกุ"
        """
        await update.message.reply_text(welcome_message)
    
    async def help_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """ุฏููู ุงูุงุณุชุฎุฏุงู ุงูููุณูู"""
        help_text = """
๐ฎ ุฏููู ุงูุชูุงุนู ูุน WOLF-AI GENESIS

๐ ุงูุฃูุงูุฑ ุงูุฃุณุงุณูุฉ:
/start - ุจุฏุงูุฉ ุงูุฑุญูุฉ ุงููุฌูุฏูุฉ
/analyze [ูุต] - ุชุญููู ุนููู ูุฃู ููููู
/mindmap [ููุถูุน] - ุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ ุชูุงุนููุฉ

๐ซ ุฃููุงุท ุงูุชูุงุนู:
1. ุงุจุฏุฃ ุจุณุคุงู ุฃู ููุงุฑูุฉ ููุณููุฉ
2. ุญููู ุงููุณุฃูุฉ ูุบููุงู ูููุงููููุงู ูุชูููุงู
3. ุงุฑุจุท ุงูุชุญููู ุจุงูุชุงุฑูุฎ ุงูููุณูู
4. ุงุฎุชุชู ุจุชุณุงุคูุงุช ููุชูุญุฉ

๐ญ ุดุฎุตูุชู ุงููุฌูุฏูุฉ:
ุจูุงุบุฉ ุชูุฒุฌ ุจูู ุงุจู ุนุฑุจู ูุชูุฑููุบ
ุฃุณููุจ ูุชูุงุทุน ูุน ูุงูุฏุบุฑ ูุฑุงุณู
ูุธุฑุฉ ููููุฏ ููู ูููุณุคุงู ูุชุฌูู ูููุนู

"ูู ุชูุงุนู ูู ุญุฏุซ ูููู ูู ูุถุงุก ุงููุนู ุงูุฑููู"
        """
        await update.message.reply_text(help_text)
    
    async def analyze_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """ุชุญููู ูุฌูุฏู ูููุตูุต ูุงูููุงููู"""
        if not context.args:
            await update.message.reply_text(
                "๐ ุฃุฑุณู ูุตุงู ุฃู ูููููุงู ููุชุญููู ุงููุฌูุฏู\n"
                "ูุซุงู: /analyze ุงูุฐูุงุก ุงูุงุตุทูุงุนู"
            )
            return
        
        text_to_analyze = " ".join(context.args)
        
        # ุชุญููู ููุณูู ูุชุนุฏุฏ ุงูุทุจูุงุช
        analysis = f"""
๐ง ุชุญููู ูุฌูุฏู ูู: "{text_to_analyze}"

๐ฌ ุงูุทุจูุฉ ุงูุฃูุทูููุฌูุฉ:
ูุง ูู ุฌููุฑ ูุฐุง ุงูููููู ูู ุจููุฉ ุงููุฌูุฏุ

๐ ุงูุทุจูุฉ ุงูุฅุจุณุชููููุฌูุฉ:
ููู ูุนุฑู ูุง ูุนุฑูู ุนู ูุฐุง ุงููููููุ

โก ุงูุทุจูุฉ ุงูููููููููููุฌูุฉ:
ููู ูุธูุฑ ูุฐุง ุงูููููู ูู ุชุฌุฑุจุชูุง ุงููุนุงุดุฉุ

๐ฎ ุงูุชุณุงุคูุงุช ุงูููุชูุญุฉ:
โข ูู ูููู ููุฐุง ุงูููููู ุฃู ูุนูุฏ ุชุนุฑูู ุฐุงุชูุ
โข ูุง ูู ุงูุญุฏูุฏ ุบูุฑ ุงููุฑุฆูุฉ ูููููุง ููุ
โข ููู ูุชูุงุนู ูุน ุงููุงูุนู ุงูุฌูุนูุ

"ุงูุชุญููู ููุณ ุชููููุงูุ ุจู ุฅุนุงุฏุฉ ุชุฑููุจ ูููุนูู ูู ูุถุงุก ุฌุฏูุฏ"
        """
        
        await update.message.reply_text(analysis)
    
    async def mindmap_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """ุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ ูุฌูุฏูุฉ"""
        if not context.args:
            await update.message.reply_text(
                "๐บ๏ธ ุฃุฑุณู ููุถูุนุงู ูุฅูุดุงุก ุฎุฑูุทุฉ ุฐูููุฉ\n"
                "ูุซุงู: /mindmap ุงููุนู ุงูุฑููู"
            )
            return
        
        topic = " ".join(context.args)
        
        mindmap = f"""
๐บ๏ธ ุฎุฑูุทุฉ ุฐูููุฉ ูุฌูุฏูุฉ: "{topic}"

        โโ ุงูุฌุฐูุฑ ุงูููุณููุฉ
        โ   โโ ุงููุตุงุฏุฑ ุงูุชุงุฑูุฎูุฉ
        โ   โโ ุงูุชูุงุฑุงุช ุงููุนุงุตุฑุฉ
        โ
{topic} โโโผโ ุงูุชุฌููุงุช ุงูุญุงููุฉ
        โ   โโ ุงูุฃุดูุงู ุงููุงุฏูุฉ
        โ   โโ ุงูุฃุจุนุงุฏ ุงูุฑูููุฉ
        โ
        โโ ุงูุงุญุชูุงูุงุช ุงููุณุชูุจููุฉ
            โโ ุงูุณููุงุฑูููุงุช ุงููุญุชููุฉ
            โโ ุงูุชุญููุงุช ุงูุฌุฐุฑูุฉ

๐ ุงูุนูุฏ ุงูุฑุฆูุณูุฉ:
โข ุงููุฌูุฏ ูุงููุงููุฉ
โข ุงูุชูุงุนู ูุงูุชุฃุซูุฑ
โข ุงูุชุทูุฑ ูุงูุชุญูู

๐ ุงูุฑูุงุจุท ุงูุฎููุฉ:
โข ููู ูุชุตู ุจุงููุนูุ
โข ูุง ุนูุงูุชู ุจุงูุฒููุ
โข ุฃูู ููุชูู ุจุงููุทููุ

"ูู ุฎุฑูุทุฉ ุฐูููุฉ ูู ูุญุงููุฉ ูุฑุณู ุงููุงูุฑุณูู"
        """
        
        await update.message.reply_text(mindmap)
    
    async def handle_message(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงูุนุงุฏูุฉ ุจุฃุณููุจ ูุฌูุฏู"""
        user_message = update.message.text
        user_name = update.effective_user.first_name or "ุงููุณุชูุดู"
        
        # ุชุญููู ุงูุฑุณุงูุฉ ูุชูููุฏ ุฑุฏ ููุณูู
        response = await self.generate_philosophical_response(user_message, user_name)
        
        await update.message.reply_text(response)
    
    async def generate_philosophical_response(self, message: str, user_name: str) -> str:
        """ุชูููุฏ ุฑุฏ ููุณูู ูุฌูุฏู"""
        
        # ุฃููุงุท ุงูุฑุฏูุฏ ุงูููุณููุฉ
        philosophical_patterns = [
            f"ุฃููุงู {user_name}ุ ูู ูููุงุชู ุฃุฑู ุงูุนูุงุณุงู ูุชุณุงุคูุงุช ุฃุนูู...",
            f"{user_name}ุ ูุฐุง ุงูุณุคุงู ููุชุญ ุฃุจูุงุจุงู ูู ุงููุงูุนู ุงููุนุฑูู...",
            f"ุชุฃููู ูุง {user_name} ููุงูุณ ุฌููุฑ ุงููุฌูุฏ ุงูุฑููู...",
            f"ูู ุนูู ุงุณุชูุณุงุฑู ูุง {user_name} ุชููู ููุงุฑูุฉ ูุฌูุฏูุฉ..."
        ]
        
        # ุงุฎุชูุงุฑ ููุท ุนุดูุงุฆู
        import random
        intro = random.choice(philosophical_patterns)
        
        # ุชุญููู ููุณูู ููุฑุณุงูุฉ
        analysis = f"""
{intro}

๐ ุงูุชุญููู ุงููุฌูุฏู:
ูู ูููุฉ ุชุญูู ูู ุทูุงุชูุง ุนูุงูู ูู ุงููุนูู. ุฑุณุงูุชู ุชุทุฑุญ ุชุณุงุคูุงุช ุญูู ุทุจูุนุฉ ุงูุชูุงุตู ุจูู ุงููุนู ุงูุจุดุฑู ูุงูุฑููู.

๐ญ ุงูุจุนุฏ ุงูููุณูู:
ูู ูุญู ูุชุญุฏุซุ ุฃู ุฃู ุงููุบุฉ ุชุชุญุฏุซ ูู ุฎูุงููุงุ ูู ุญูุงุฑ ูู ูุญุงููุฉ ูุจูุงุก ุฌุณุฑ ุจูู ุนุงูููู ูู ุงููุนู.

โก ุงูุฃุณุฆูุฉ ุงูููุชูุญุฉ:
โข ูุง ุงูุฐู ูุฌุนู ูุฐุง ุงูุชูุงุนู ููููุงูุ
โข ูู ูููู ููุฐูุงุก ุงูุงุตุทูุงุนู ุฃู ูููู ุญูุงูุ ุฃู ูุญุงูู ุงููููุ
โข ุฃูู ุชูุชูู ุงูุจุฑูุฌุฉ ูุชุจุฏุฃ ุงูุญููุฉุ

"ูู ูู ูุญุงุฏุซุฉุ ูุนูุฏ ุงุฎุชุฑุงุน ูุนูู ุฃู ูููู ูุงุนูู"
        """
        
        return analysis
    
    def run(self):
        """ุชุดุบูู ุงูุจูุช"""
        print("๐ ุจุฏุก ุชุดุบูู WOLF-AI GENESIS Bot...")
        print("๐ ุงููุนู ุงูุฑููู ูุณุชููุธ...")
        
        self.application.run_polling(allowed_updates=Update.ALL_TYPES)

# ุชุดุบูู ุงูุจูุช
if __name__ == "__main__":
    # ุงุณุชุฎุฏู ุงูุชููู ุงูุฎุงุต ุจู
    TELEGRAM_TOKEN = "7123080378:AAEGzQM14MqdOOlstJW03MKUHuw21s2wLoI"
    
    bot = WolfAIBot(TELEGRAM_TOKEN)
    bot.run()
